<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rollen-zu-Bogen Rechner</title>

  <style>
    body {
      font-family: system-ui, Arial, sans-serif;
      margin: 0;
      background: #f4f6fb;
      color: #111;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
    }

    .topbar {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 22px;
      background: #0a7a2f;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.10);
      margin-bottom: 20px;
    }

    .logoBox {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      border-radius: 14px;
      padding: 10px 12px;
      min-width: 180px;
      height: 92px;
      box-sizing: border-box;
      border: 2px solid rgba(0,0,0,0.08);
    }

    .siteLabel {
      font-size: 22px;
      font-weight: 900;
      letter-spacing: 1px;
      color: #0a7a2f;
      text-transform: uppercase;
    }

    .titleblock h1 {
      margin: 0;
      font-size: 34px;
      font-weight: 900;
      color: #111;
    }

    .subtitle {
      font-size: 14px;
      margin-top: 6px;
      font-weight: 600;
      color: #111;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    @media (min-width: 1000px) {
      .grid { grid-template-columns: 1fr 1fr; }
    }

    .card {
      background: white;
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.07);
    }

    label {
      display: block;
      font-size: 13px;
      font-weight: 700;
      margin: 12px 0 6px;
      color: #111;
    }

    input, select {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #cfd6e4;
      font-size: 15px;
      box-sizing: border-box;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .btn {
      margin-top: 18px;
      width: 100%;
      padding: 14px;
      border-radius: 14px;
      border: 0;
      background: #00b56a;
      color: white;
      font-size: 16px;
      font-weight: 800;
      cursor: pointer;
    }

    .btn:hover { background: #009a59; }
    .btn:active { background: #008a4f; transform: translateY(1px); }

    .kpi {
      background: #f3f6ff;
      border: 1px solid #dbe5ff;
      border-radius: 14px;
      padding: 12px;
    }

    .kpi .t {
      font-size: 13px;
      color: #334;
      font-weight: 700;
    }

    .kpi .v {
      font-size: 20px;
      font-weight: 900;
      margin-top: 4px;
      color: #111;
    }

    .ok { color: #0a7a2f; }
    .bad { color: #b00020; }

    .small {
      font-size: 12px;
      color: #555;
      margin-top: 6px;
      line-height: 1.35;
    }

    /* Rechterkant structuur */
    .sectionTitle{
      font-size: 14px;
      font-weight: 900;
      margin: 6px 0 10px;
      color: #111;
    }

    .sectionBox{
      margin-top: 16px;
      padding-top: 14px;
      border-top: 1px solid #e3e9f7;
    }

    .outGrid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
  </style>
</head>

<body>
<div class="wrap">

  <div class="topbar">
    <div class="logoBox">
      <div class="siteLabel">Baienfurt</div>
    </div>

    <div class="titleblock">
      <h1>Rollen-zu-Bogen Rechner</h1>
      <div class="subtitle">
        Rollenlänge, Bogen, Paletten und Auftragsprüfung. Zusätzlich Rollengewicht und Durchmesser berechnen.
      </div>
    </div>
  </div>

  <div class="grid">

    <div class="card">
      <label>Außendurchmesser der Rolle (mm)</label>
      <input id="dOut" placeholder="Beispiel 1600">

      <div class="row">
        <div>
          <label>Kerndurchmesser (mm)</label>
          <input id="dCore" value="330">
        </div>
        <div>
          <label>Materialstärke (µm)</label>
          <input id="thickness" placeholder="Beispiel 380">
        </div>
      </div>

      <div class="row">
        <div>
          <label>Grammatur (g/m²)</label>
          <input id="grammage" placeholder="Beispiel 265">
        </div>
        <div>
          <label>Rollenbreite (mm)</label>
          <input id="rollWidth" placeholder="Beispiel 2180">
        </div>
      </div>

      <label>Rollengewicht (kg)</label>
      <input id="rollWeightKg" placeholder="Beispiel 2500">
      <div class="small">
        Wenn der Außendurchmesser leer ist, wird er aus Rollengewicht, Grammatur, Rollenbreite, Kerndurchmesser und Materialstärke berechnet und automatisch in das Durchmesserfeld geschrieben.
        Wenn das Rollengewicht leer ist, wird es aus Außendurchmesser, Grammatur und Rollenbreite berechnet und automatisch in das Rollengewichtfeld geschrieben.
      </div>

      <label>Bogenlänge (mm)</label>
      <input id="sheetLen" placeholder="Beispiel 850 wird 850,5" onblur="enforceHalf(this)">

      <label>Anzahl der Bahnen</label>
      <select id="lanes">
        <option value="1">1 Bahn</option>
        <option value="2">2 Bahnen</option>
        <option value="3">3 Bahnen</option>
        <option value="4">4 Bahnen</option>
        <option value="5">5 Bahnen</option>
        <option value="6">6 Bahnen</option>
        <option value="7">7 Bahnen</option>
        <option value="8">8 Bahnen</option>
      </select>
      <div class="small">
        Gesamtanzahl Bogen ist Bogen pro Bahn multipliziert mit der Anzahl der Bahnen.
      </div>

      <div class="row">
        <div>
          <label>Bogen pro Palette</label>
          <input id="sheetsPer" placeholder="Beispiel 2000">
        </div>
        <div>
          <label>Noch benötigte Bogen</label>
          <input id="needed" placeholder="Beispiel 8500">
        </div>
      </div>

      <button class="btn" id="calcBtn" type="button">BERECHNEN</button>
    </div>

    <div class="card">

      <div class="sectionTitle">ROLLE</div>
      <div class="outGrid">
        <div class="kpi">
          <div class="t">Rollenlänge (m)</div>
          <div class="v" id="rollLen">.</div>
        </div>

        <div class="kpi">
          <div class="t">Rollengewicht (kg)</div>
          <div class="v" id="rollWeightView">.</div>
        </div>
      </div>

      <div class="sectionBox">
        <div class="sectionTitle">BOGEN UND PALETTEN</div>
        <div class="outGrid">
          <div class="kpi">
            <div class="t">Bogen pro Bahn</div>
            <div class="v" id="sheetsLane">.</div>
          </div>

          <div class="kpi">
            <div class="t">Gesamtanzahl Bogen</div>
            <div class="v" id="sheetsTotal">.</div>
          </div>

          <div class="kpi">
            <div class="t">Paletten möglich pro Bahn</div>
            <div class="v" id="palletsLane">.</div>
          </div>

          <div class="kpi">
            <div class="t">Paletten gesamt</div>
            <div class="v" id="palletsTotal">.</div>
          </div>
        </div>
      </div>

      <div class="sectionBox">
        <div class="sectionTitle">AUFTRAGSPRÜFUNG</div>
        <div class="outGrid">
          <div class="kpi">
            <div class="t">Ausreichend</div>
            <div class="v" id="enough">.</div>
          </div>

          <div class="kpi">
            <div class="t">Differenz (Bogen)</div>
            <div class="v" id="diff">.</div>
          </div>
        </div>
      </div>

      <div class="small" style="margin-top:12px">
        Gewicht und Durchmesser funktionieren ohne Bogenlänge. Bogen und Paletten benötigen eine Bogenlänge. Paletten benötigen die Angabe Bogen pro Palette.
      </div>
    </div>

  </div>
</div>

<script>
  function n(v){
    return Number((v || "").toString().trim().replace(",", "."));
  }

  function formatComma(s){
    return (s || "").toString().replace(".", ",");
  }

  function enforceHalf(input){
    if(!input) return;
    let raw = (input.value || "").toString().trim();
    if(!raw) return;

    raw = raw.replace(",", ".");
    const num0 = Number(raw);
    if(!Number.isFinite(num0)) return;

    const num = Math.floor(num0) + 0.5;
    input.value = formatComma(num.toString());
  }

  function resetOut(){
    document.getElementById("rollLen").textContent = ".";
    document.getElementById("rollWeightView").textContent = ".";
    document.getElementById("sheetsLane").textContent = ".";
    document.getElementById("sheetsTotal").textContent = ".";
    document.getElementById("palletsLane").textContent = ".";
    document.getElementById("palletsTotal").textContent = ".";
    document.getElementById("diff").textContent = ".";
    const enoughEl = document.getElementById("enough");
    enoughEl.textContent = ".";
    enoughEl.className = "v";
  }

  function setEnough(msg, isBad){
    const enoughEl = document.getElementById("enough");
    enoughEl.textContent = msg;
    enoughEl.className = "v " + (isBad ? "bad" : "ok");
  }

  function calcOuterDiaFromWeightKg(kg, g, rwMm, dCoreMm, tMicron){
    const widthM = rwMm / 1000;
    const areaM2 = (kg * 1000) / g;
    const lenM = areaM2 / widthM;
    const D2 = (dCoreMm * dCoreMm) + ((4 * tMicron * lenM) / Math.PI);
    if(!(D2 > dCoreMm * dCoreMm)) return null;
    return Math.sqrt(D2);
  }

  function calcLengthFromDia(dOutMm, dCoreMm, tMicron){
    if(!(dOutMm > dCoreMm) || !(tMicron > 0)) return null;
    return ((Math.PI / (4 * (tMicron / 1000))) * (dOutMm * dOutMm - dCoreMm * dCoreMm)) / 1000;
  }

  function calcWeightFromLength(lenM, g, rwMm){
    const area = lenM * (rwMm / 1000);
    return (area * g) / 1000;
  }

  function updateRollWeightView(){
    const viewEl = document.getElementById("rollWeightView");
    const kgNow = n(document.getElementById("rollWeightKg").value);
    if(viewEl){
      viewEl.textContent = (kgNow > 0) ? kgNow.toFixed(1) : ".";
    }
  }

  function calc(){
    resetOut();

    const dOutEl = document.getElementById("dOut");
    const dCoreEl = document.getElementById("dCore");
    const thicknessEl = document.getElementById("thickness");
    const sheetLenEl = document.getElementById("sheetLen");
    const lanesEl = document.getElementById("lanes");
    const sheetsPerEl = document.getElementById("sheetsPer");
    const neededEl = document.getElementById("needed");
    const grammageEl = document.getElementById("grammage");
    const rollWidthEl = document.getElementById("rollWidth");
    const rollWeightEl = document.getElementById("rollWeightKg");

    enforceHalf(sheetLenEl);

    let dOut = n(dOutEl.value);
    const dCore = n(dCoreEl.value);
    const t = n(thicknessEl.value);
    const sl = n(sheetLenEl.value);
    const lanes = n(lanesEl.value) || 1;
    const sp = n(sheetsPerEl.value);
    const need = n(neededEl.value);
    const g = n(grammageEl.value);
    const rw = n(rollWidthEl.value);
    const kgIn = n(rollWeightEl.value);

    if(!(dCore > 0) || !(t > 0)){
      setEnough("EINGABE?", true);
      updateRollWeightView();
      return;
    }

    if(!(dOut > 0) && (kgIn > 0) && (g > 0) && (rw > 0)){
      const dCalc = calcOuterDiaFromWeightKg(kgIn, g, rw, dCore, t);
      if(dCalc){
        dOut = dCalc;
        dOutEl.value = formatComma(dCalc.toFixed(0));
      }
    }

    if(!(dOut > dCore)){
      setEnough("DURCHMESSER?", true);
      updateRollWeightView();
      return;
    }

    const len = calcLengthFromDia(dOut, dCore, t);
    if(!(len > 0)){
      setEnough("LÄNGE?", true);
      updateRollWeightView();
      return;
    }

    document.getElementById("rollLen").textContent = len.toFixed(1);

    if(g > 0 && rw > 0){
      const kgCalc = calcWeightFromLength(len, g, rw);
      if(!(kgIn > 0)){
        rollWeightEl.value = formatComma(kgCalc.toFixed(1));
      }
    }

    updateRollWeightView();

    if(!(sl > 0)){
      setEnough("OK", false);
      return;
    }

    const perLane = (len * 1000) / sl;
    const total = perLane * lanes;

    document.getElementById("sheetsLane").textContent = Math.round(perLane).toString();
    document.getElementById("sheetsTotal").textContent = Math.round(total).toString();

    if(Number.isFinite(sp) && sp > 0){
      const palletsLane = perLane / sp;
      const palletsTotal = total / sp;
      document.getElementById("palletsLane").textContent = palletsLane.toFixed(2);
      document.getElementById("palletsTotal").textContent = palletsTotal.toFixed(2);
    }

    if(Number.isFinite(need) && need >= 0){
      const diffv = Math.round(total - need);
      document.getElementById("diff").textContent = diffv.toString();
      setEnough(diffv >= 0 ? "JA" : "NEIN", diffv < 0);
    } else {
      setEnough("OK", false);
    }
  }

  document.getElementById("calcBtn").addEventListener("click", calc);
</script>
</body>
</html>

